(()=>{"use strict";function e(e){var t,i=e.createId,n=e.questionId,o=e.questionMode,c=e.title,a=e.mode,s=e.hasDisabled,d="add"==a?(null!==(t=$(".choices-box-".concat(n)).find(".choice-container").last().data("choiceId"))&&void 0!==t?t:0)+1:i,u=$(".choices-box-".concat(n)).find(".choice-container").length<2,r='<div class="choice-container input-group has-validation mb-3" id="choice-'.concat(n,"-").concat(d,'" data-choice-id="').concat(d,'">\n                        <input type="text"\n                        class="form-control choice-input"\n                        id="question[').concat(o,"][").concat(n,"][choice][").concat(a,"][").concat(d,']"\n                        name="question[').concat(o,"][").concat(n,"][choice][").concat(a,"][").concat(d,']" value="').concat(null!=c?c:"",'" required ').concat(s?"disabled":"",">\n                        ").concat(u?"":'<button class="btn btn-danger choice-item-delete" type="button"><i class="bi-trash"></i></button>','\n                        <div class="invalid-feedback">\n                            لطفا متن پاسخ را وارد کنید\n                        </div>\n                    </div>');$(".choices-box-".concat(n)).append(r)}function t(t){var i,c=t.createId,a=t.title,s=t.description,d=t.has_choice,u=t.has_descriptive,r=t.has_multiple_choice,l=t.choice_count,h=t.mode,m="add"==h?(null!==(i=$(".question-container").last().data("questionId"))&&void 0!==i?i:0)+1:c,p=0==$(".question-container").length,q='<div class="d-flex question-container my-2" id="question-item-'.concat(m,'" data-question-id="').concat(m,'" data-question-mode="').concat(h,'">\n                        <div div class = "').concat(p?"col-12":"col-11",' d-flex align-items-center question-item-box" >\n                            <span class="col p-2 text-center question-item-num"></span>\n                            <span class="col-11 p-2 question-item-title">').concat(null!=a?a:"عنوان سوال","</span>\n                        </div>\n                        ").concat(p?"":'<div class="col-1 d-flex align-items-center justify-content-center question-item-delete">\n                            <i class="bi-trash"></i>\n                            </div>',"\n                    </div>");$(".questions-box").append(q),function(t){var i=t.id,n=t.title,o=t.description,c=t.has_choice,a=t.has_descriptive,s=t.has_multiple_choice,d=t.choice_count,u=t.mode,r='<div class="question-form" id="question-box-'.concat(i,'" data-question-mode="').concat(u,'" data-question-id="').concat(i,'" data-question-num="" aria-hidden="true">\n                        <input type="hidden"\n                        name="question[').concat(u,"][").concat(i,'][id]"\n                        value="').concat(i,'"/>\n                        <div class="d-flex justify-content-center">\n                            <span class="h5">جزئیات سوال <small class="question-item-num"></small></span>\n                        </div>\n                        <div class="question-content py-3">\n                            <div class="form-floating mb-3">\n                                <input type="text"\n                                class="form-control question-title-input"\n                                id="question[').concat(u,"][").concat(i,'][title]"\n                                name="question[').concat(u,"][").concat(i,'][title]"\n                                    placeholder="عنوان سوال" value="').concat(null!=n?n:"",'" required>\n                                <label for="question[').concat(u,"][").concat(i,'][title]">عنوان</label>\n                                <div class="invalid-feedback">\n                                    لطفا عنوان سوال را وارد نمایید\n                                </div>\n                            </div>\n                            <div class="form-floating">\n                                <textarea textarea class = "form-control"\n                                id = "question[').concat(u,"][").concat(i,'][description]"\n                                name = "question[').concat(u,"][").concat(i,'][description]"\n                                style = "height: 100px"\n                                    placeholder="توضیحات سوال">').concat(null!=o?o:"",'</textarea>\n                                <label for="question[').concat(u,"][").concat(i,'][description]">توضیحات</label>\n                                <div id="descriptionQuestionHelp" class="form-text">(اختیاری)\n                                در صورت نیاز به توضیح بیشتر از این بخش استفاده کنید\n                                </div>\n                            </div>\n                        </div>\n                        <div class="d-flex justify-content-center mt-3">\n                            <span class="h5">تنظیمات سوال <small class="question-item-num"></small></span>\n                        </div>\n                        <div class="question-content py-3">\n                            <div id="descriptionQuestionHelp" class="form-text mb-3">حداقل باید یک نوع پاسخ انتخاب کنید\n                            </div>\n                            <div class="form-check form-switch mb-3">\n                                <input ').concat("edit"==u?1==a?"checked":"":"checked",' class="has-descriptive-input form-check-input" type="checkbox" id="question[').concat(u,"][").concat(i,'][has_descriptive]"\n                                    name="question[').concat(u,"][").concat(i,'][has_descriptive]">\n                                <label class="form-check-label" for="question[').concat(u,"][").concat(i,'][has_descriptive]">دارای پاسخ تشریحی می باشد</label>\n                            </div>\n                            <div class="form-check form-switch mb-4">\n                                <input ').concat("edit"==u&&1==c?"checked":"",' class="has-choice-input form-check-input" type="checkbox" id="question[').concat(u,"][").concat(i,'][has_choice]" name="question[').concat(u,"][").concat(i,'][has_choice]">\n                                <label class="form-check-label" for="question[').concat(u,"][").concat(i,'][has_choice]">دارای پاسخ گزینه ای می باشد</label>\n                            </div>\n                            <div class="multiple-choice-container form-check form-switch mb-3"\n                            aria-hidden="true">\n                                <input ').concat("edit"==u&&1==s?"checked":"",' class="has-multiple-choice-input form-check-input" type="checkbox" id="question[').concat(u,"][").concat(i,'][has_multiple_choice]"\n                                    name="question[').concat(u,"][").concat(i,'][has_multiple_choice]" ').concat("edit"==u&&1==c?"":"disabled",'>\n                                <label class="form-check-label"\n                                for="question[').concat(u,"][").concat(i,'][has_multiple_choice]" > دارای چند انتخاب هم زمان می\n                                    باشد</label>\n                            </div>\n                        </div>\n                        <div class="choice-container"\n                        aria-hidden="true">\n                            <div class="d-flex justify-content-center mt-3">\n                                <span class="h5">گزینه های سوال <small class="question-item-num"></small></span>\n                            </div>\n                            <div class="question-content py-3">\n                                <div class="choices-box-').concat(i,'"></div>\n                                <div class="d-flex align-items-center choice-add-box my-2">\n                                    <span class="col text-center p-1"><i class="bi-plus-lg"></i></span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>');if($(".question-forms").append(r),"add"==u)for(var l=0;l<2;l++)e({questionId:i,questionMode:u,mode:"add",hasDisabled:!0});if("edit"==u&&0==d)for(var h=0;h<2;h++)e({questionId:i,questionMode:u,mode:"add",hasDisabled:!0})}({id:m,title:a,description:s,has_choice:d,has_descriptive:u,has_multiple_choice:r,choice_count:l,mode:h}),n(),o({id:m,mode:h})}function i(e){var t=e.id,i=e.questionMode,c=e.mode;o({id:t,mode:c}),$("#question-item-".concat(t)).remove(),console.log(i),"edit"==i&&$(".delete-questions").append('<input type="hidden" name="question[delete][]" value="'.concat(t,'">')),function(e){var t=e.id;e.mode,$("#question-box-".concat(t)).remove()}({id:t,mode:c}),n()}function n(){for(var e=$(".question-container"),t=0;t<e.length;t++){var i=$(e[t]).data("questionId");$(e[t]).find(".question-item-num").text(t+1),$("#question-box-".concat(i)).find(".question-item-num").text("(".concat(t+1,")")),$("#question-box-".concat(i)).attr("data-question-num",t+1)}}function o(e){var t=e.id,i=e.mode;if("add"==i)return $(".question-item-box").removeClass("active"),$('.question-container[data-question-id="'.concat(t,'"]')).find(".question-item-box").addClass("active"),$(".question-form").attr("aria-hidden",!0),$("#question-box-".concat(t)).attr("aria-hidden",!1),!0;if("edit"==i)$(".question-item-box").removeClass("active"),$('.question-container[data-question-id="'.concat(t,'"]')).find(".question-item-box").addClass("active"),$(".question-form").attr("aria-hidden",!0),$("#question-box-".concat(t)).attr("aria-hidden",!1);else if("delete"==i){if(1==$('.question-container[data-question-id="'.concat(t,'"]')).find(".question-item-box.active").length){$(".question-item-box").removeClass("active");var n=$('.question-container[data-question-id="'.concat(t,'"]')).prev().data("questionId");return $('.question-container[data-question-id="'.concat(n,'"]')).find(".question-item-box").addClass("active"),$(".question-form").attr("aria-hidden",!0),$("#question-box-".concat(n)).attr("aria-hidden",!1),!0}}else if("show"==i)return $(".question-item-box").removeClass("active"),$('.question-container[data-question-id="'.concat(t,'"]')).find(".question-item-box").addClass("active"),$(".question-form").attr("aria-hidden",!0),$("#question-box-".concat(t)).attr("aria-hidden",!1),!0}function c(e){var t=e.id,i=e.text,n=e.type,o='<li class="mb-1" data-question-num="'.concat(t,'" data-error-type="').concat(n,'">\n                    ').concat(i,"\n                </li>");$(".error-questions").append(o)}!function(){var i=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(i).forEach((function(e){e.addEventListener("submit",(function(t){if(!e.checkValidity()){t.preventDefault(),t.stopPropagation(),void 0===(l={}.id)&&$(".error-questions").empty(),$('.error-questions li[data-question-num="'.concat(l,'"]')).remove();for(var i=$(".question-title-input:invalid").parents(".question-form"),n=i.length-1;n>=0;n--){var o=i[n],a=$(o).attr("data-question-num");c({id:$(o).data("questionId"),text:"لطفا عنوان سوال ".concat(a," را تکمیل کنید"),type:"title"})}for(var s=$(".choice-input:invalid").parents(".question-form"),d=s.length-1;d>=0;d--){var u=s[d],r=$(u).attr("data-question-num");c({id:$(u).data("questionId"),text:"لطفا گزینه های سوال ".concat(r," را تکمیل کنید"),type:"choice"})}}var l;e.classList.add("was-validated")}),!1)}));for(var n=0;n<serverToJs.questions.length;n++){var o=serverToJs.questions[n];if(t({createId:o.id,title:o.title,description:o.description,has_choice:o.has_choice,has_descriptive:o.has_descriptive,has_multiple_choice:o.has_multiple_choice,choice_count:o.choice_count,mode:"edit"}),1==o.has_choice){var a=$("#question-box-".concat(o.id));a.find(".multiple-choice-container").attr("aria-hidden",!1),a.find(".choice-container").attr("aria-hidden",!1),a.find(".choice-input").prop("disabled",!1)}}for(var s=0;s<serverToJs.choices.length;s++){var d=serverToJs.choices[s];e({createId:d.id,questionId:d.question_id,questionMode:"edit",title:d.title,mode:"edit",hasDisabled:!1})}}(),$(document).on("click",".question-add-box",(function(){t({mode:"add"}),$("form").removeClass("was-validated")})),$(document).on("click",".question-item-delete",(function(){i({id:$(this).parents(".question-container").data("questionId"),questionMode:$(this).parents(".question-container").data("questionMode"),mode:"delete"})})),$(document).on("click",".question-item-box",(function(){var e;o({id:(e={id:$(this).parents(".question-container").data("questionId"),mode:"show"}).id,mode:e.mode})})),$(document).on("click",".choice-add-box",(function(){e({questionId:$(this).parents(".question-form").data("questionId"),questionMode:$(this).parents(".question-form").data("questionMode"),mode:"add"})})),$(document).on("click",".choice-item-delete",(function(){var e,t,i,n;e={id:$(this).parents(".choice-container").data("choiceId"),questionId:$(this).parents(".question-form").data("questionId"),questionMode:$(this).parents(".question-form").data("questionMode"),mode:"add"},t=e.id,i=e.questionId,n=e.questionMode,e.mode,$("#choice-".concat(i,"-").concat(t)).remove(),"edit"==n&&$(".delete-choices").append('<input type="hidden" name="choices[delete][]" value="'.concat(t,'">'))})),$(document).on("input",".question-title-input",(function(){var e=$(this).parents(".question-form").data("questionId"),t=$('.question-container[data-question-id="'.concat(e,'"]')).find(".question-item-title");if(""==$(this).val())return t.text("عنوان سوال"),!1;t.text($(this).val())})),$(document).on("change",".has-choice-input",(function(){var e=$(this).parents(".question-form");if($(this).is(":checked"))return e.find(".multiple-choice-container").attr("aria-hidden",!1),e.find(".has-multiple-choice-input").prop("disabled",!1),e.find(".choice-container").attr("aria-hidden",!1),e.find(".choice-input").prop("disabled",!1),!0;e.find(".has-descriptive-input").is(":checked")||e.find(".has-descriptive-input").prop("checked",!0),e.find(".multiple-choice-container").attr("aria-hidden",!0),e.find(".has-multiple-choice-input").prop("disabled",!0),e.find(".choice-container").attr("aria-hidden",!0),e.find(".choice-input").prop("disabled",!0)})),$(document).on("change",".has-descriptive-input",(function(){var e=$(this).parents(".question-form");if($(this).is(":checked"))return!0;e.find(".has-choice-input").is(":checked")||(e.find(".has-choice-input").prop("checked",!0),e.find(".multiple-choice-container").attr("aria-hidden",!1),e.find(".has-multiple-choice-input").prop("disabled",!1),e.find(".choice-container").attr("aria-hidden",!1),e.find(".choice-input").prop("disabled",!1))}))})();
//# sourceMappingURL=edit.js.map